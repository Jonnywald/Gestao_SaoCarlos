/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package View;

import Model.Bean.Barril;
import Model.Bean.ProducaoCachaca;
import Model.DAO.BarrilDAO;
import Model.DAO.CachacaDAO;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author guilherme.bertola
 */
public class ProducaoCachacaView extends javax.swing.JFrame {

    /**
     * Creates new form ProducaoCachacaView
     */
    public ProducaoCachacaView() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        painelNovoLote = new javax.swing.JPanel();
        lblLote = new javax.swing.JLabel();
        txtLote = new javax.swing.JTextField();
        lblDtMoagem = new javax.swing.JLabel();
        ftxtDtMoagem = new javax.swing.JFormattedTextField();
        lblQtdCaldo = new javax.swing.JLabel();
        txtQtdCaldo = new javax.swing.JTextField();
        lblBrix = new javax.swing.JLabel();
        txtBrix = new javax.swing.JTextField();
        lblAgua = new javax.swing.JLabel();
        txtQtdAgua = new javax.swing.JTextField();
        lblTotalCaldo = new javax.swing.JLabel();
        txtTotalCaldo = new javax.swing.JTextField();
        lblDtInicioFerment = new javax.swing.JLabel();
        ftxtDtInicioFerment = new javax.swing.JFormattedTextField();
        lblDtAlarmeFerment = new javax.swing.JLabel();
        ftxtDtAlarmeFerment = new javax.swing.JFormattedTextField();
        lblNumDorna = new javax.swing.JLabel();
        cmbDorna = new javax.swing.JComboBox<>();
        btnVoltarLote = new javax.swing.JButton();
        btnLancarLote = new javax.swing.JButton();
        txtLabeProduçãoCachaça = new javax.swing.JLabel();
        painelEmAndamento = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblLista = new javax.swing.JTable();
        jSeparator1 = new javax.swing.JSeparator();
        lblDtAlambicagem = new javax.swing.JLabel();
        lblQtdCoracao = new javax.swing.JLabel();
        txtQtdCoracao = new javax.swing.JTextField();
        ftxtDtAlambicagem = new javax.swing.JFormattedTextField();
        lblRendimento = new javax.swing.JLabel();
        txtRendimento = new javax.swing.JTextField();
        lblGL = new javax.swing.JLabel();
        txtGL = new javax.swing.JTextField();
        lblNumBarril = new javax.swing.JLabel();
        cmbBarril = new javax.swing.JComboBox<>();
        btnVoltarAndamento = new javax.swing.JButton();
        btnLacarDestilacao = new javax.swing.JButton();
        painelHistorico = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblHist = new javax.swing.JTable();
        btnVoltarHist = new javax.swing.JButton();
        btnAtualizar = new javax.swing.JButton();
        btnExcluir = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowActivated(java.awt.event.WindowEvent evt) {
                formWindowActivated(evt);
            }
        });

        jPanel1.setBackground(new java.awt.Color(111, 148, 148));

        lblLote.setText("Lote:");

        txtLote.setText("0001");
        txtLote.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtLoteActionPerformed(evt);
            }
        });

        lblDtMoagem.setText("Data de Moagem:");

        ftxtDtMoagem.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("dd/MM/yyyy"))));
        ftxtDtMoagem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ftxtDtMoagemActionPerformed(evt);
            }
        });

        lblQtdCaldo.setText("Quantidade de Caldo (L):");

        lblBrix.setText("Grau Brix:");

        txtBrix.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtBrixFocusLost(evt);
            }
        });

        lblAgua.setText("Quantidade de Agua (L):");

        txtQtdAgua.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtQtdAguaFocusLost(evt);
            }
        });

        lblTotalCaldo.setText("Total de Caldo (L):");

        lblDtInicioFerment.setText("Data de Inicio da fermentação:");

        ftxtDtInicioFerment.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("dd/MM/yyyy"))));
        ftxtDtInicioFerment.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                ftxtDtInicioFermentFocusLost(evt);
            }
        });
        ftxtDtInicioFerment.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ftxtDtInicioFermentActionPerformed(evt);
            }
        });

        lblDtAlarmeFerment.setText("Data maxima de fermentação:");

        ftxtDtAlarmeFerment.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("dd/MM/yyyy"))));
        ftxtDtAlarmeFerment.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ftxtDtAlarmeFermentActionPerformed(evt);
            }
        });

        lblNumDorna.setText("Numero da Dorna:");

        cmbDorna.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Dorna 1", "Dorna 2" }));

        btnVoltarLote.setText("Voltar");
        btnVoltarLote.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVoltarLoteActionPerformed(evt);
            }
        });

        btnLancarLote.setText("Lançar Lote");
        btnLancarLote.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLancarLoteActionPerformed(evt);
            }
        });

        txtLabeProduçãoCachaça.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        txtLabeProduçãoCachaça.setText("Produção de Cachaça");

        javax.swing.GroupLayout painelNovoLoteLayout = new javax.swing.GroupLayout(painelNovoLote);
        painelNovoLote.setLayout(painelNovoLoteLayout);
        painelNovoLoteLayout.setHorizontalGroup(
            painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelNovoLoteLayout.createSequentialGroup()
                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, painelNovoLoteLayout.createSequentialGroup()
                        .addContainerGap(474, Short.MAX_VALUE)
                        .addComponent(btnLancarLote)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnVoltarLote))
                    .addGroup(painelNovoLoteLayout.createSequentialGroup()
                        .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(painelNovoLoteLayout.createSequentialGroup()
                                .addGap(19, 19, 19)
                                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(lblNumDorna)
                                    .addComponent(lblDtAlarmeFerment)
                                    .addComponent(lblDtInicioFerment)
                                    .addComponent(lblTotalCaldo)
                                    .addComponent(lblAgua)
                                    .addComponent(lblBrix)
                                    .addComponent(lblQtdCaldo)
                                    .addComponent(lblDtMoagem)
                                    .addComponent(lblLote))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(ftxtDtMoagem)
                                    .addComponent(txtQtdCaldo)
                                    .addComponent(txtBrix)
                                    .addComponent(txtQtdAgua)
                                    .addComponent(txtTotalCaldo)
                                    .addComponent(ftxtDtInicioFerment)
                                    .addComponent(ftxtDtAlarmeFerment)
                                    .addComponent(cmbDorna, javax.swing.GroupLayout.PREFERRED_SIZE, 125, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(txtLote, javax.swing.GroupLayout.DEFAULT_SIZE, 447, Short.MAX_VALUE)))
                            .addGroup(painelNovoLoteLayout.createSequentialGroup()
                                .addGap(32, 32, 32)
                                .addComponent(txtLabeProduçãoCachaça)))
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap())
        );
        painelNovoLoteLayout.setVerticalGroup(
            painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelNovoLoteLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtLabeProduçãoCachaça)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 272, Short.MAX_VALUE)
                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblLote)
                    .addComponent(txtLote, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblDtMoagem)
                    .addComponent(ftxtDtMoagem, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblQtdCaldo)
                    .addComponent(txtQtdCaldo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblBrix)
                    .addComponent(txtBrix, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblAgua)
                    .addComponent(txtQtdAgua, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblTotalCaldo)
                    .addComponent(txtTotalCaldo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblDtInicioFerment)
                    .addComponent(ftxtDtInicioFerment, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblDtAlarmeFerment)
                    .addComponent(ftxtDtAlarmeFerment, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblNumDorna)
                    .addComponent(cmbDorna, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(painelNovoLoteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnVoltarLote)
                    .addComponent(btnLancarLote))
                .addContainerGap())
        );

        jTabbedPane1.addTab("Novo Lote", painelNovoLote);

        tblLista.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Lote", "Data de Fermentação", "Volume", "Dorna"
            }
        ));
        jScrollPane1.setViewportView(tblLista);

        lblDtAlambicagem.setText("Data da Alambicagem:");

        lblQtdCoracao.setText("Quantidade de coração (L):");

        txtQtdCoracao.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtQtdCoracaoFocusLost(evt);
            }
        });

        ftxtDtAlambicagem.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("dd/MM/yyyy"))));

        lblRendimento.setText("Rendimento (%):");

        lblGL.setText("Grau Alcoólico:");

        lblNumBarril.setText("Numero do Barril:");

        cmbBarril.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Barril 1", "Barril 2", "Barril 3", "Barril 4", "Barril 5", "Barril 6", "Barril 7", "Barril 8", "Barril 9", "Barril 10", "Barril 11", "Barril 12" }));

        btnVoltarAndamento.setText("Voltar");
        btnVoltarAndamento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVoltarAndamentoActionPerformed(evt);
            }
        });

        btnLacarDestilacao.setText("Lançar Destilação");
        btnLacarDestilacao.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLacarDestilacaoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout painelEmAndamentoLayout = new javax.swing.GroupLayout(painelEmAndamento);
        painelEmAndamento.setLayout(painelEmAndamentoLayout);
        painelEmAndamentoLayout.setHorizontalGroup(
            painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelEmAndamentoLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(painelEmAndamentoLayout.createSequentialGroup()
                        .addGroup(painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 620, Short.MAX_VALUE)
                            .addComponent(jSeparator1))
                        .addContainerGap())
                    .addGroup(painelEmAndamentoLayout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addGroup(painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(lblQtdCoracao)
                            .addComponent(lblDtAlambicagem)
                            .addComponent(lblRendimento)
                            .addComponent(lblGL)
                            .addComponent(lblNumBarril))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(txtQtdCoracao)
                            .addComponent(ftxtDtAlambicagem)
                            .addComponent(txtRendimento)
                            .addComponent(txtGL)
                            .addComponent(cmbBarril, 0, 125, Short.MAX_VALUE))
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, painelEmAndamentoLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnLacarDestilacao)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnVoltarAndamento)
                .addContainerGap())
        );
        painelEmAndamentoLayout.setVerticalGroup(
            painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelEmAndamentoLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblDtAlambicagem)
                    .addComponent(ftxtDtAlambicagem, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblQtdCoracao)
                    .addComponent(txtQtdCoracao, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblRendimento)
                    .addComponent(txtRendimento, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblGL)
                    .addComponent(txtGL, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblNumBarril)
                    .addComponent(cmbBarril, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 270, Short.MAX_VALUE)
                .addGroup(painelEmAndamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnVoltarAndamento)
                    .addComponent(btnLacarDestilacao))
                .addContainerGap())
        );

        jTabbedPane1.addTab("Em andamento", painelEmAndamento);

        tblHist.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Lote", "Data de Moagem", "Qtd Caldo", "Brix", "Qtd Agua", "Volume", "Data de Fermentação", "Data Maxima", "Dorna", "Data de Destilação", "Coração", "GL", "Rendimento", "Barril"
            }
        ));
        jScrollPane2.setViewportView(tblHist);

        btnVoltarHist.setText("Voltar");
        btnVoltarHist.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVoltarHistActionPerformed(evt);
            }
        });

        btnAtualizar.setText("Relistar");
        btnAtualizar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAtualizarActionPerformed(evt);
            }
        });

        btnExcluir.setText("Excluir");
        btnExcluir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExcluirActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout painelHistoricoLayout = new javax.swing.GroupLayout(painelHistorico);
        painelHistorico.setLayout(painelHistoricoLayout);
        painelHistoricoLayout.setHorizontalGroup(
            painelHistoricoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelHistoricoLayout.createSequentialGroup()
                .addGroup(painelHistoricoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 630, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, painelHistoricoLayout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addComponent(btnExcluir)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnAtualizar)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnVoltarHist)))
                .addContainerGap())
        );
        painelHistoricoLayout.setVerticalGroup(
            painelHistoricoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelHistoricoLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 327, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 231, Short.MAX_VALUE)
                .addGroup(painelHistoricoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnVoltarHist)
                    .addComponent(btnAtualizar)
                    .addComponent(btnExcluir)))
        );

        jTabbedPane1.addTab("Historico", painelHistorico);

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 835, Short.MAX_VALUE)
            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel1Layout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(jTabbedPane1)
                    .addContainerGap()))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 642, Short.MAX_VALUE)
            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel1Layout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(jTabbedPane1)
                    .addContainerGap()))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnVoltarLoteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVoltarLoteActionPerformed
        // TODO add your handling code here:
        this.dispose();
    }//GEN-LAST:event_btnVoltarLoteActionPerformed

    private void btnVoltarAndamentoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVoltarAndamentoActionPerformed
        // TODO add your handling code here:
        this.dispose();
    }//GEN-LAST:event_btnVoltarAndamentoActionPerformed

    private void btnLancarLoteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLancarLoteActionPerformed
        // TODO add your handling code here:
        ProducaoCachaca pCachaca = new ProducaoCachaca();
        CachacaDAO cDAO = new CachacaDAO();

        pCachaca.setLote(Integer.parseInt(txtLote.getText()));
        Date dtMoag = null, dtIn = null, dtAl = null;
        try {
            dtMoag = new SimpleDateFormat("dd/MM/yyyy").parse(ftxtDtMoagem.getText());
            dtIn = new SimpleDateFormat("dd/MM/yyyy").parse(ftxtDtInicioFerment.getText());
            dtAl = new SimpleDateFormat("dd/MM/yyyy").parse(ftxtDtAlarmeFerment.getText());
        } catch (ParseException ex) {
            Logger.getLogger(ProducaoCachacaView.class.getName()).log(Level.SEVERE, null, ex);
        }
        pCachaca.setDtMoagem(dtMoag);
        pCachaca.setQtdCaldo((int)Double.parseDouble(txtQtdCaldo.getText()));
        pCachaca.setQtdAgua((int)Double.parseDouble(txtQtdAgua.getText()));
        pCachaca.setBrix(Double.parseDouble(txtBrix.getText()));
        pCachaca.setTotalCaldo((int)Double.parseDouble(txtTotalCaldo.getText()));
        pCachaca.setDtInicioFerment(dtIn);
        pCachaca.setDtAlarmFerment(dtAl);
        pCachaca.setNumDorna(cmbDorna.getSelectedIndex() + 1);

        cDAO.IniciarProducao(pCachaca);
    }//GEN-LAST:event_btnLancarLoteActionPerformed

    private void formWindowActivated(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowActivated
        // TODO add your handling code here:
        CachacaDAO cDAO = new CachacaDAO();
        Integer i = 0;
        i = cDAO.ultimoLote() + 1;
        txtLote.setText(i.toString());
        List<ProducaoCachaca> pc = new ArrayList<ProducaoCachaca>();
        cmbBarril.removeAllItems();
        BarrilDAO bDAO = new BarrilDAO();
        List<Barril> barris = new ArrayList<Barril>();
        barris = bDAO.ListarBarril();
        barris.forEach(b -> {
            cmbBarril.addItem(b.getNumBarril().toString());
        });
        // comando da classe de acesso ao banco de usuarios para buscar todos os usuarios cadastrados
        pc = cDAO.ListarProducao();
        // instanciamentdo de objeto para manipulacao de tabela
        DefaultTableModel modelo = (DefaultTableModel) tblLista.getModel();
        DefaultTableModel modeloH = (DefaultTableModel) tblHist.getModel();
        // zerar o numero de linha da tabela
        modelo.setNumRows(0);
        modeloH.setNumRows(0);
        // para cada usuario que iremos nos referir genericamente por U iremos realizar a açao entre chaves
        pc.forEach(p -> {
            // adiciona uma linha na tabela com os dados do usuario U em questao
            if (p.getDtAlambicagem() == null) {
                modelo.addRow(new Object[]{
                    p.getLote(), p.getDtInicioFerment(), p.getTotalCaldo(), p.getNumDorna()
                });
                
            }
            modeloH.addRow(new Object[]{
                p.getLote(),
                p.getDtMoagem(),
                p.getQtdCaldo(),
                p.getBrix(),
                p.getQtdAgua(),
                p.getTotalCaldo(),
                p.getDtInicioFerment(),
                p.getDtAlarmFerment(),
                p.getNumDorna(),
                p.getDtAlambicagem(),
                p.getQtdCoracao(),
                p.getGl(),
                p.getRendimento(),
                p.getNumBarril()
            });
        });


    }//GEN-LAST:event_formWindowActivated

    private void btnLacarDestilacaoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLacarDestilacaoActionPerformed
        // TODO add your handling code here:
        ProducaoCachaca pCachaca = new ProducaoCachaca();
        CachacaDAO cDAO = new CachacaDAO();
        Integer bLote = (int) tblLista.getValueAt(tblLista.getSelectedRow(), 0);
        pCachaca = cDAO.BuscaLote(bLote);
        Date alam = null;
        try {
            alam = new SimpleDateFormat("dd/MM/yyyy").parse(ftxtDtAlambicagem.getText());
        } catch (ParseException ex) {
            Logger.getLogger(ProducaoCachacaView.class.getName()).log(Level.SEVERE, null, ex);
        }
        pCachaca.setDtAlambicagem(alam);
        pCachaca.setQtdCoracao(Double.parseDouble(txtQtdCoracao.getText()));
        pCachaca.setRendimento(Double.parseDouble(txtRendimento.getText()));
        pCachaca.setGl(Double.parseDouble(txtGL.getText()));
        pCachaca.setNumBarril(Integer.parseInt(cmbBarril.getSelectedItem().toString()));
        Barril b = new Barril();
        BarrilDAO bDAO = new BarrilDAO();
        b = bDAO.BuscaBarril(pCachaca.getNumBarril());
        if (b.checkVolume(pCachaca.getQtdCoracao())){
           b.addVolume(pCachaca.getQtdCoracao());
           bDAO.AtualizarVolumeBarril(b);
           cDAO.FinalizarProducao(pCachaca); 
        } else {
            JOptionPane.showMessageDialog(null, "Volume ultrapassa o limite do barril selecionado!");
        }
        
    }//GEN-LAST:event_btnLacarDestilacaoActionPerformed

    private void btnVoltarHistActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVoltarHistActionPerformed
        // TODO add your handling code here:
        this.dispose();
    }//GEN-LAST:event_btnVoltarHistActionPerformed

    private void btnAtualizarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAtualizarActionPerformed
        // TODO add your handling code here:
        CachacaDAO cDAO = new CachacaDAO();
        List<ProducaoCachaca> pc = new ArrayList<ProducaoCachaca>();
        // comando da classe de acesso ao banco de usuarios para buscar todos os usuarios cadastrados
        pc = cDAO.ListarProducao();
        // instanciamentdo de objeto para manipulacao de tabela
        DefaultTableModel modelo = (DefaultTableModel) tblHist.getModel();
        // zerar o numero de linha da tabela
        modelo.setNumRows(0);
        // para cada usuario que iremos nos referir genericamente por U iremos realizar a açao entre chaves
        pc.forEach(p -> {
            // adiciona uma linha na tabela com os dados do usuario U em questao
            modelo.addRow(new Object[]{
                p.getLote(),
                p.getDtMoagem(),
                p.getQtdCaldo(),
                p.getBrix(),
                p.getQtdAgua(),
                p.getTotalCaldo(),
                p.getDtInicioFerment(),
                p.getDtAlarmFerment(),
                p.getNumDorna(),
                p.getDtAlambicagem(),
                p.getQtdCoracao(),
                p.getGl(),
                p.getRendimento(),
                p.getNumBarril()
            });
        });
    }//GEN-LAST:event_btnAtualizarActionPerformed

    private void btnExcluirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExcluirActionPerformed
        // TODO add your handling code here:
        ProducaoCachaca pCachaca = new ProducaoCachaca();
        CachacaDAO cDAO = new CachacaDAO();
        Integer bLote = (Integer) tblHist.getValueAt(tblHist.getSelectedRow(), 0);
        pCachaca = cDAO.BuscaLote(bLote);
        cDAO.Delete(pCachaca);
    }//GEN-LAST:event_btnExcluirActionPerformed

    private void txtQtdAguaFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtQtdAguaFocusLost
        // TODO add your handling code here:
        Double tot = Double.parseDouble(txtQtdAgua.getText()) + Integer.parseInt(txtQtdCaldo.getText());
        txtTotalCaldo.setText(tot.toString());
    }//GEN-LAST:event_txtQtdAguaFocusLost

    private void ftxtDtAlarmeFermentActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ftxtDtAlarmeFermentActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ftxtDtAlarmeFermentActionPerformed

    private void txtBrixFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtBrixFocusLost
        // TODO add your handling code here:
        Double brix, qtdC, qtdA;
        brix = Double.parseDouble(txtBrix.getText());
        qtdC = Double.parseDouble(txtQtdCaldo.getText());
        qtdA = (brix * qtdC / 15) - qtdC;
        txtQtdAgua.setText(qtdA.toString());
    }//GEN-LAST:event_txtBrixFocusLost

    private void txtLoteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtLoteActionPerformed
        // TODO add your handling code he
    }//GEN-LAST:event_txtLoteActionPerformed

    private void txtQtdCoracaoFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtQtdCoracaoFocusLost
        Double rend;
        rend = Double.parseDouble(txtQtdCoracao.getText()) / ((int) tblLista.getValueAt(tblLista.getSelectedRow(), 2)) * 100;
        txtRendimento.setText(rend.toString());
    }//GEN-LAST:event_txtQtdCoracaoFocusLost


    private void ftxtDtMoagemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ftxtDtMoagemActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ftxtDtMoagemActionPerformed

   
//
    private void ftxtDtInicioFermentFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_ftxtDtInicioFermentFocusLost
        // TODO add your handling code here:
        try {
            // TODO add your handling code here:
            SimpleDateFormat formato = new SimpleDateFormat("dd/MM/yyyy");
            Date dataFormatada = formato.parse(ftxtDtInicioFerment.getText());
            Calendar c = Calendar.getInstance();
            c.setTime(dataFormatada);
            
            c.add(c.DATE, 2);
            dataFormatada = c.getTime();
            ftxtDtAlarmeFerment.setText(formato.format(dataFormatada));
        } catch (ParseException ex) {
            Logger.getLogger(ProducaoCachacaView.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_ftxtDtInicioFermentFocusLost

    private void ftxtDtInicioFermentActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ftxtDtInicioFermentActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ftxtDtInicioFermentActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(ProducaoCachacaView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(ProducaoCachacaView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(ProducaoCachacaView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(ProducaoCachacaView.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */  
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new ProducaoCachacaView().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAtualizar;
    private javax.swing.JButton btnExcluir;
    private javax.swing.JButton btnLacarDestilacao;
    private javax.swing.JButton btnLancarLote;
    private javax.swing.JButton btnVoltarAndamento;
    private javax.swing.JButton btnVoltarHist;
    private javax.swing.JButton btnVoltarLote;
    private javax.swing.JComboBox<String> cmbBarril;
    private javax.swing.JComboBox<String> cmbDorna;
    private javax.swing.JFormattedTextField ftxtDtAlambicagem;
    private javax.swing.JFormattedTextField ftxtDtAlarmeFerment;
    private javax.swing.JFormattedTextField ftxtDtInicioFerment;
    private javax.swing.JFormattedTextField ftxtDtMoagem;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JLabel lblAgua;
    private javax.swing.JLabel lblBrix;
    private javax.swing.JLabel lblDtAlambicagem;
    private javax.swing.JLabel lblDtAlarmeFerment;
    private javax.swing.JLabel lblDtInicioFerment;
    private javax.swing.JLabel lblDtMoagem;
    private javax.swing.JLabel lblGL;
    private javax.swing.JLabel lblLote;
    private javax.swing.JLabel lblNumBarril;
    private javax.swing.JLabel lblNumDorna;
    private javax.swing.JLabel lblQtdCaldo;
    private javax.swing.JLabel lblQtdCoracao;
    private javax.swing.JLabel lblRendimento;
    private javax.swing.JLabel lblTotalCaldo;
    private javax.swing.JPanel painelEmAndamento;
    private javax.swing.JPanel painelHistorico;
    private javax.swing.JPanel painelNovoLote;
    private javax.swing.JTable tblHist;
    private javax.swing.JTable tblLista;
    private javax.swing.JTextField txtBrix;
    private javax.swing.JTextField txtGL;
    private javax.swing.JLabel txtLabeProduçãoCachaça;
    private javax.swing.JTextField txtLote;
    private javax.swing.JTextField txtQtdAgua;
    private javax.swing.JTextField txtQtdCaldo;
    private javax.swing.JTextField txtQtdCoracao;
    private javax.swing.JTextField txtRendimento;
    private javax.swing.JTextField txtTotalCaldo;
    // End of variables declaration//GEN-END:variables
}
